{"version":3,"file":"naive.js","sources":["../../src/utils.js","../../src/dom.js","../../src/vdom/vtext.js","../../src/vdom/vnode.js","../../src/vdom/utils.js","../../src/vdom/patch.js","../../src/vdom/list-diff.js","../../src/vdom/diff.js","../../src/vdom/h.js","../../src/cache.js","../../src/parser.js","../../src/api/hooks.js","../../src/main.js"],"sourcesContent":["export function warn (message) {\n  if (window.console) {\n    console.warn(`[naive.js] ${message}`);\n  }\n}\n\nexport function error (message) {\n  if (window.console) {\n    console.error(`[naive.js] ${message}`);\n  }\n}\n\nexport const isArray = Array.isArray ? Array.isArray : function isArray (obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]';\n};\n\nexport function isUndefined (obj) {\n  return typeof obj === 'undefined';\n}\n\nexport function noop () {}\n\nexport function extend(obj, props) {\n  if (props) {\n    for (let i in props) obj[i] = props[i];\n  }\n  return obj;\n}\n\nexport function clone(obj) {\n  return extend({}, obj);\n}\n\nexport function isFunction (obj) {\n  return typeof obj === 'function';\n}\n\nexport function isPlainObject (obj) {\n  return obj != null && typeof obj === 'object' && !isArray(obj) && Object.prototype.toString.call(obj) === '[object Object]';\n}\n\nlet resolved = typeof Promise!=='undefined' && Promise.resolve();\nexport const defer = resolved ? (f => { resolved.then(f); }) : setTimeout; // asap async\n","import { isUndefined } from './utils';\n\n/**\n * è·å–å…ƒç´ \n *\n * IE 8 åªæ”¯æŒåˆ° CSS2 é€‰æ‹©å™¨\n *\n * @param {String} selector\n */\nexport function getElement(selector) {\n  return typeof selector === 'string' ? query(selector) : selector;\n}\n\nexport function createElement(tag) {\n  return document.createElement(tag);\n}\n\nexport function createTextNode (text) {\n  return document.createTextNode(text);\n}\n\nexport function createDocumentFragment () {\n  return document.createDocumentFragment();\n}\n\nexport function query(selector, context) {\n  context = context || document;\n  return context.querySelector(selector);\n}\n\n/**\n * æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ document å†…\n */\nexport function inDoc(node) {\n  var doc = node.ownerDocument.documentElement;\n  return doc === node || node && node.nodeType === 1 && doc.contains(node);\n}\n\nexport function removeNode(node) {\n  node.parentNode.removeChild(node)\n}\n\nexport function createAnchor(name) {\n  var n = document.createTextNode('');\n  n.name = name;\n  return n;\n}\n\nexport function before(newNode, node) {\n  node.parentNode.insertBefore(newNode, node);\n}\n\nexport function replaceNode(newNode, node) {\n  node.parentNode.replaceChild(newNode, node);\n}\n\nexport function after(el, target) {\n  if (target.nextSibling) {\n    before(el, target.nextSibling)\n  } else {\n    target.parentNode.appendChild(el)\n  }\n}\n\nexport function appendChild (el, target) {\n  target.appendChild(el);\n}\n\nexport function setAttr (node, attr, value) {\n  node.setAttribute(attr, value);\n}\n\nexport function hasAttr(node, name) {\n  return node.hasAttribute(name);\n}\n\nexport function removeAttr(node, name) {\n  node.removeAttribute(name);\n}\n\nexport function removeAllChildren(node) {\n  while(node.childNodes.length > 0) {\n    node.removeChild(node.childNodes[0]);\n  }\n}\n\n\nconst classSplitReg = /\\s+/;\n\nconst supportClassList = !isUndefined(document.createElement('div').classList);\n\nlet getClasses = supportClassList ?\n  function(element) {\n    return Array.prototype.slice.call(element.classList);\n  }\n  :\n  function(element) {\n    return element.className.split(/\\s+/).filter(s => s);\n  };\n\nexport let hasClass = supportClassList ?\n  function(element, classes) {\n    classes = classes.split(/\\s+/).filter(s => s);\n    var contains = true;\n    for (let i = 0; i < classes.length; ++i) {\n      if (!element.classList.contains(classes[i])) {\n        contains = false;\n        break;\n      }\n    }\n    return contains;\n  }\n  :\n  function(element, classes) {\n    classes = classes.split(/\\s+/).filter(s => s);\n    var contains = true, tmp = element.className;\n    for (let i = 0; i < classes.length; ++i) {\n      if (tmp.indexOf(classes[i]) === -1) {\n        contains = false;\n        break;\n      }\n    }\n    return contains;\n  };\n\nexport let addClass = supportClassList ?\n  function(element, classes) {\n    classes = classes.split(/\\s+/).filter(s => s);\n    element.classList.add.apply(element.classList, classes);\n    return element;\n  }\n  :\n  function(element, classes) {\n    var tmp = element.className;\n    classes = classes.split(/\\s+/).filter(s => s);\n    classes.forEach(c => {\n      if (!hasClass(element, c)) {\n        tmp = tmp.replace(/\\s+|$/, ' ' + classes);\n      }\n    });\n    element.className = tmp;\n    return element;\n  };\n\nexport let removeClass = supportClassList ?\n  function(element, classes) {\n    classes = classes.split(/\\s+/).filter(s => s);\n    element.classList.remove.apply(element.classList, classes);\n    return element;\n  }\n  :\n  function(element, classes) {\n    var tmp = element.className;\n    classes = classes.split(/\\s+/).filter(s => s);\n    classes.forEach(c => {\n      if (hasClass(element, c)) {\n        tmp = tmp.replace(new RegExp(c, 'g'), '');\n      }\n    });\n    element.className = tmp;\n    return element;\n  };\n\nexport let toggleClass = supportClassList ?\n  function(element, classes, force) {\n    classes = classes.split(/\\s+/).filter(s => s);\n    classes.forEach(c => {\n      element.classList.toggle(c, force);\n    });\n    return element;\n  }\n  :\n  function(element, classes, force) {\n    classes = classes.split(/\\s+/).filter(s => s);\n    var useForce = force !== undefined;\n    classes.forEach(c => {\n      if (hasClass(element, c) && (useForce && !force || !useForce)) {\n        removeClass(element, c);\n      } else if (!hasClass(element, c) && (useForce && force || !useForce)) {\n        addClass(element, c);\n      }\n    });\n    return element;\n  };\n","import { createTextNode } from '../dom';\n\n// virtual text node\nexport default function VText (text) {\n  this.data = text;\n}\n\nVText.prototype.render = function vdom2dom () {\n  return createTextNode(this.data);\n};\n","import { createElement, setAttr, appendChild } from '../dom';\nimport VText from './vtext';\nimport { isVNode, isVText } from './utils';\n\nexport default function VNode (tagName, props, children, key) {\n  this.tagName = tagName;\n  this.props = props || {};\n  this.key = key ? String(key) : undefined; // key ç”¨æ¥æ ‡è¯†èŠ‚ç‚¹ï¼Œæ–¹ä¾¿ diff\n  const childNodes = [];\n  children = children || [];\n  for (let i = 0; i < children.length; ++i) {\n    const child = children[i];\n    if (isVNode(child) || isVText(child)) {\n      childNodes.push(child);\n    } else if (typeof child === 'string') {\n      childNodes.push(new VText(child));\n    } else {\n      // error\n    }\n  }\n  this.children = childNodes;\n  let count = this.children.length;\n  for (let i = 0; i < this.children.length; ++i) {\n    count += this.children[i].count || 0;\n  }\n  this.count = count; // è®°å½•å­èŠ‚ç‚¹æ•°ï¼Œæ–¹ä¾¿ patch çš„æ—¶å€™æ‰¾åˆ°èŠ‚ç‚¹ä½ç½®\n}\n\n// æ£€æŸ¥æ˜¯å¦æŒ‡ä»¤å±æ€§\nfunction checkAttrDirective (attr) {\n  return /^@|n-|:/.test(attr);\n}\n\n// add event listener\nfunction isEventDirective (attr) {\n  return /^@/.test(attr);\n}\n\nfunction attachEvent (el, eventName, handler) {\n  if (el.addEventListener) {\n    el.addEventListener(eventName, handler, false);\n  } else if (el.attachEvent) {\n    el.attachEvent(eventName, handler);\n  } else {\n    el[`on${eventName}`] = handler;\n  }\n}\n\nfunction detachEvent () {}\n\nVNode.prototype.render = function vdom2dom(context) {\n  const el = createElement(this.tagName);\n  const props = this.props;\n  for (let p in props) {\n    if (checkAttrDirective(p)) {\n      if (isEventDirective(p)) {\n        const eventName = p.slice(1);\n        attachEvent(el, eventName, function handler(evt) {\n          props[p].call(context, evt);\n        });\n      } else {\n        // å¤„ç†æŒ‡ä»¤\n      }\n    } else {\n      setAttr(el, p, props[p]);\n    }\n  }\n  for (let i = 0; i < this.children.length; ++i) {\n    appendChild(this.children[i].render(context), el);\n  }\n  return el;\n};\n","import VText from './vtext';\nimport VNode from './vnode';\n\nexport function isVNode (node) {\n  return node instanceof VNode;\n}\n\nexport function isVText (node) {\n  return node instanceof VText;\n}\n","import { setAttr, replaceNode, removeNode } from '../dom';\n\nexport const PATCH = {\n  REPLACE: 0, // æ›¿æ¢èŠ‚ç‚¹\n  INSERT: 1, // æ’å…¥\n  REMOVE: 2, // ç§»é™¤\n  REORDER: 3, // é‡æ’\n  PROPS: 4, // ä¿®æ”¹å±æ€§\n  TEXT: 5 // æ›¿æ¢æ–‡æœ¬\n};\n\nexport function patch (context, domNode, patches) {\n  dfsWalk(context, domNode, 0, patches);\n}\n\nfunction dfsWalk (context, domNode, index, patches) {\n  const currentPatches = patches[index];\n\n  const len = domNode.childNodes ? domNode.childNodes.length : 0;\n  for (let i = 0; i < len; i++) {\n    const child = domNode.childNodes[i];\n    index++;\n    dfsWalk(context, child, index, patches);\n  }\n  if (currentPatches) {\n    applyPatches(context, domNode, currentPatches);\n  }\n}\n\nfunction patchReorder (context, domNode, moves) {\n  for (let i = 0; i < moves.length; ++i) {\n    const move = moves[i];\n    switch (move.type) {\n      case PATCH.INSERT: // æ’å…¥æ–°èŠ‚ç‚¹\n        const target = domNode.childNodes[move.index] || null; // null æ’å…¥æœ«å°¾\n        domNode.insertBefore(move.item.render(context), target);\n        break;\n      case PATCH.REMOVE:\n        removeNode(domNode.childNodes[move.index]);\n        break;\n      default:\n        // error type\n    }\n  }\n}\n\n// æ£€æŸ¥æ˜¯å¦æŒ‡ä»¤å±æ€§\nfunction isAttrDirective (attr) {\n  return /^@|n-|:/.test(attr);\n}\n// æ£€æŸ¥æ˜¯å¦äº‹ä»¶æŒ‡ä»¤\nfunction isEventDirective (attr) {\n  return /^@/.test(attr);\n}\n\nfunction patchProps (domNode, patch) {\n  for (let p in patch.props) {\n    if (patch.props.hasOwnProperty(p)) {\n      // æ£€æŸ¥æ˜¯å¦æŒ‡ä»¤å±æ€§\n      if (isAttrDirective(p)) {\n        if (isEventDirective(p)) {\n          // removeEventListener\n          // addEventListener\n        } else { // å…¶ä»–æŒ‡ä»¤å±æ€§\n        }\n      } else { // æ™®é€šå±æ€§\n        setAttr(domNode, p, patch.props[p]);\n      }\n    }\n  }\n}\n\n// æ ¹æ®è¡¥ä¸æ›´æ–° DOM èŠ‚ç‚¹\nfunction applyPatches (context, domNode, patches) {\n  for (let i = 0; i < patches.length; ++i) {\n    const patch = patches[i];\n    switch (patch.type) {\n      case PATCH.REPLACE: // æ›¿æ¢å…ƒç´ èŠ‚ç‚¹\n        replaceNode(patch.node.render(context), domNode);\n        break;\n      case PATCH.PROPS: // å±æ€§ä¿®æ”¹\n        patchProps(domNode, patch);\n        break;\n      case PATCH.TEXT: // æ›¿æ¢æ–‡æœ¬å†…å®¹\n        domNode.data = patch.data;\n        break;\n      case PATCH.REORDER: // å­èŠ‚ç‚¹é‡æ–°æ’åº\n        patchReorder(context, domNode, patch.moves);\n        break;\n      default:\n        // warn\n    }\n  }\n}\n","import { PATCH } from './patch'; //REORDER_INSERT\n\n// åˆ†åˆ«æ‰¾åˆ°æœ‰ key çš„å…ƒç´ ä½ç½®å’Œæ²¡æœ‰ key çš„å…ƒç´ çš„ä½ç½®\nfunction makeKeyIndexAndFree (list) {\n  const keyIndex = {}; // æœ‰ key çš„èŠ‚ç‚¹ä½ç½®\n  const free = []; // å¯æ›¿æ¢çš„ä½ç½®ï¼ˆæ²¡æœ‰ key çš„èŠ‚ç‚¹éƒ½è¢«æ ‡è¯†ä¸ºå¯æ›¿æ¢çš„èŠ‚ç‚¹ï¼‰\n  for (let i = 0, len = list.length; i < len; i++) {\n    const item = list[i]\n    const itemKey = item.key;\n    if (itemKey) {\n      keyIndex[itemKey] = i;\n    } else {\n      free.push(item);\n    }\n  }\n  return {\n    keyIndex: keyIndex,\n    free: free\n  };\n}\n\nexport default function listDiff (pList, nList) {\n  const nMap = makeKeyIndexAndFree(nList);\n  const nKeys = nMap.keyIndex, nFree = nMap.free;\n  const pMap = makeKeyIndexAndFree(pList);\n  const pKeys = pMap.keyIndex, pFree = pMap.free;\n  // å…ˆå¤„ç†æœ‰ key çš„å…ƒç´ ï¼Œçœ‹å…¶åœ¨ nList è¿˜æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨è¯´æ˜è¢«ç§»é™¤\n  const children = [];\n  for (let i = 0, freeIndex = 0; i < pList.length; ++i) {\n    const item = pList[i];\n    const itemKey = item.key;\n    if (itemKey) {\n      if (!nKeys.hasOwnProperty(itemKey)) {\n        children.push(null);\n      } else {\n        const itemKeyIndex = nKeys[itemKey];\n        children.push(nList[itemKeyIndex]);\n      }\n    } else {\n      children.push(nFree[freeIndex++] || null);\n    }\n  }\n  const moves = [];\n  function remove (index) {\n    moves.push({\n      type: PATCH.REMOVE,\n      index: index\n    });\n  }\n  function insert (index, item) {\n    moves.push({\n      type: PATCH.INSERT,\n      index: index,\n      item: item\n    });\n  }\n  const simulateList = children.slice(0);\n  // æ‰¾å‡ºè¢«ç§»é™¤çš„èŠ‚ç‚¹\n  let i = 0;\n  while (i < simulateList.length) {\n    if (simulateList[i] === null) {\n      remove(i);\n      simulateList.splice(i, 1);\n    } else {\n      ++i;\n    }\n  }\n  // éå† nList\n  for (let s = 0, n = 0; n < nList.length; ++n) {\n    const nItem = nList[n];\n    const nItemKey = nItem.key;\n    const sItem = simulateList[s];\n    if (sItem) {\n      const sItemKey = sItem.key;\n      if (sItemKey === nItemKey) { // ç›¸åŒå…ƒç´ ç›¸åŒä½ç½®\n        s++;\n      } else {\n        if (!pKeys.hasOwnProperty(nItemKey)) { // æ—§åˆ—è¡¨ä¸­ä¸å­˜åœ¨ï¼Œæ–°èŠ‚ç‚¹\n          insert(n, nItem); // åœ¨ä½ç½® n æ’å…¥æ–°èŠ‚ç‚¹ nItem\n        } else { // æ—§åˆ—è¡¨ä¸­å­˜åœ¨ï¼Œéœ€è¦ç§»ä½ï¼ˆç§»ä½æ“ä½œåŒ…æ‹¬åˆ é™¤å’Œæ’å…¥ä¸¤è€…ä¸­çš„ä¸€ä¸ªæˆ–ä¸¤ä¸ªï¼‰\n        }\n      }\n    } else { // æ—§åˆ—è¡¨è¯¥ä½ç½®ä¸ºç©ºï¼Œç›´æ¥æ’å…¥\n      insert(n, nItem);\n    }\n  }\n  return {\n    moves: moves,\n    children: children\n  };\n}\n","import { isVNode, isVText } from './utils';\nimport listDiff from './list-diff';\nimport { PATCH } from './patch';\n\n// diff two vdom node\nexport function diff (oldTree, newTree) {\n  let index = 0;\n  let patches = {};\n  diffWalk(oldTree, newTree, index, patches);\n  return patches;\n}\n\nfunction diffWalk (pNode, nNode, index, patches) {\n  let currentPatches = []; // å½“å‰å±‚çº§çš„ patch\n  if (nNode === null) {\n    // è¿™ç§æƒ…å†µå±äºï¼šåœ¨ diffChildren çš„æ—¶å€™è¯¥èŠ‚ç‚¹è¢«æ ‡è¯†ä¸ºè¢«åˆ é™¤çš„èŠ‚ç‚¹ï¼Œä½†æ˜¯ä¸éœ€è¦åœ¨è¿™é‡Œåˆ é™¤ï¼ˆåœ¨ reorder çš„æ—¶å€™ä¼šå¤„ç†åˆ é™¤ï¼‰\n  } else if (isVNode(pNode) && isVNode(nNode)) { // éƒ½æ˜¯ VNode\n    if (pNode.tagName !== nNode.tagName || pNode.key !== nNode.key) { // ä¸åŒèŠ‚ç‚¹ï¼Œæˆ–è€…å·²æ ‡è¯†ä¸æ˜¯åŒä¸€èŠ‚ç‚¹ï¼Œè¦æ›¿æ¢\n      currentPatches.push({type: PATCH.REPLACE, node: nNode});\n    } else {\n      let propsPatches = diffProps(pNode, nNode);\n      if (propsPatches) {\n        currentPatches.push({type: PATCH.PROPS, props: propsPatches});\n      }\n      // ç»§ç»­ diff å­èŠ‚ç‚¹\n      diffChildren(pNode.children, nNode.children, index, patches, currentPatches);\n    }\n  } else if (isVText(pNode) && isVText(nNode)) { // éƒ½æ˜¯ VText\n    if (pNode.data !== nNode.data) { // å†…å®¹ä¸ä¸€æ ·çš„æ—¶å€™æ‰æ›¿æ¢ï¼ˆåªæ›¿æ¢å†…å®¹å³å¯ï¼‰\n      currentPatches.push({type: PATCH.TEXT, data: nNode.data});\n    }\n  } else { // ç±»å‹ä¸ä¸€æ ·ï¼Œç»å¯¹è¦æ›¿æ¢\n    currentPatches.push({type: PATCH.REPLACE, node: nNode});\n  }\n  patches[index] = currentPatches;\n}\n\nfunction diffProps (oldTree, newTree) {\n  let oldTreeProps = oldTree.props;\n  let newTreeProps = newTree.props;\n  let propsPatches = {}, count = 0;\n  for (let p in oldTreeProps) {\n    if (!newTreeProps.hasOwnProperty(p) || newTreeProps[p] !== oldTreeProps[p]) {\n      propsPatches[p] = newTreeProps[p];\n      count += 1;\n    }\n  }\n  if (count <= 0) {\n    return null;\n  }\n  return propsPatches;\n}\n\nfunction diffChildren (pChildNodes, nChildNodes, index, patches, currentPatches) {\n  const diffs = listDiff(pChildNodes, nChildNodes, index, patches);\n  const newChildren = diffs.children;\n\n  if (diffs.moves.length) { // éœ€è¦ reorder\n    // reorder çš„æ“ä½œåœ¨çˆ¶èŠ‚ç‚¹æ‰§è¡Œï¼Œæ‰€ä»¥åº”è¯¥åŠ åˆ°çˆ¶èŠ‚ç‚¹çš„ patch\n    const reorderPatch = { type: PATCH.REORDER, moves: diffs.moves };\n    currentPatches.push(reorderPatch);\n  }\n  \n  // é™¤äº†é‡æ’çš„ patch è¿˜æœ‰å„ä¸ªå­èŠ‚ç‚¹è‡ªèº«çš„ patch\n  let leftNode = null;\n  let currentNodeIndex = index;\n  for (let i = 0; i < pChildNodes.length; ++i) {\n    currentNodeIndex = (leftNode && leftNode.count)\n      ? currentNodeIndex + leftNode.count + 1\n      : currentNodeIndex + 1\n    diffWalk(pChildNodes[i], newChildren[i], currentNodeIndex, patches);\n    leftNode = pChildNodes[i];\n  }\n}\n","import VNode from './vnode';\n\nexport default function h (tagName, props, children) {\n  return new VNode(tagName, props, children);\n}\n","/**\n * åŒå‘é“¾è¡¨å®ç°çš„ä½¿ç”¨ LRU ç®—æ³•çš„ç¼“å­˜\n * ç¼“å­˜æœ€è¿‘æœ€å¸¸ç”¨çš„é¡¹ç›®ï¼Œå½“ç¼“å­˜æ»¡æ—¶ä¸¢å¼ƒæœ€è¿‘æœ€å°‘ç”¨çš„é¡¹ç›®\n *\n * @param {Number} ç¼“å­˜æœ€å¤§é™åˆ¶\n * @constructor\n */\n\nexport default function Cache (limit) {\n  this.size = 0; // ç¼“å­˜å¤§å°\n  this.limit = limit; // ç¼“å­˜å¤§å°æœ€å¤§é™åˆ¶\n  this.head = this.tail = undefined; // å¤´å°¾æŒ‡é’ˆ\n  this._keymap = Object.create(null); // ç¼“å­˜æ˜ å°„è¡¨\n}\n\nvar p = Cache.prototype;\n\n/**\n * å°† <key> <value> é”®å€¼å¯¹å­˜å‚¨åˆ°ç¼“å­˜æ˜ å°„è¡¨\n * å¦‚æœç¼“å­˜æ»¡äº†ï¼Œåˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹è®©å‡ºç©ºé—´ç»™æ–°çš„ç¼“å­˜ï¼Œå¹¶è¿”å›è¢«åˆ çš„èŠ‚ç‚¹\n * å¦åˆ™è¿”å› undefined\n *\n * @param {String} é”®\n * @param {*} å€¼\n * @return {Entry|undefined}\n */\n\np.put = function (key, value) {\n  var removed;\n\n  var entry = this.get(key, true); // å…ˆæŸ¥çœ‹æ˜¯å¦å·²ç»æœ‰ç¼“å­˜ï¼Œå¦‚æœæœ‰ï¼Œåªéœ€è¦æ›´æ–°å®ƒçš„ value å°±å¯ä»¥äº†\n  if (!entry) {\n    if (this.size === this.limit) { // ç¼“å­˜æ»¡äº†\n      removed = this.shift();\n    }\n    entry = {\n      key: key\n    };\n    this._keymap[key] = entry;\n    if (this.tail) {\n      this.tail.newer = entry;\n      entry.older = this.tail;\n    } else {\n      this.head = entry;\n    }\n    this.tail = entry; // å°†è¿™ä¸ªé¡¹ç›®ä½œä¸ºæœ€æ–°çš„æ’å…¥ç¼“å­˜\n    this.size++;\n  }\n  entry.value = value;\n\n  return removed;\n}\n\n/**\n * ä»ç¼“å­˜ä¸­æ¸…é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆæ”¾å¾—æœ€ä¹…çš„ï¼‰é¡¹ç›®\n * è¿”å›è¢«æ¸…é™¤çš„é¡¹ç›®ï¼Œå¦‚æœç¼“å­˜ä¸ºç©ºå°±è¿”å› undefined\n */\n\np.shift = function () {\n  var entry = this.head;\n  if (entry) {\n    this.head = this.head.newer; // å¤´éƒ¨çš„æ˜¯æœ€æ—§çš„ï¼Œæ‰€ä»¥è¦ä»å¤´éƒ¨å¼€å§‹æ¸…é™¤\n    this.head.older = undefined;\n    entry.newer = entry.older = undefined;\n    this._keymap[entry.key] = undefined;\n    this.size--;\n  }\n  return entry;\n}\n\n/**\n * è·å–å¹¶ä¸”æ³¨å†Œæœ€è¿‘ä½¿ç”¨çš„ <key>\n * è¿”å› <key> å¯¹åº”çš„å€¼\n * å¦‚æœç¼“å­˜ä¸­æ‰¾ä¸åˆ°è¿™ä¸ª <key> å°±è¿”å› undefined\n *\n * @param {String} é”®\n * @param {Boolean} æ˜¯å¦è¿”å›æ•´ä¸ª entry ï¼Œå¦‚æœä¸º false åˆ™åªè¿”å› value\n * @return {Entry|*} è¿”å› Entry æˆ–è€…å®ƒçš„å€¼ï¼Œæˆ–è€… undefined\n */\n\np.get = function (key, returnEntry) {\n  var entry = this._keymap[key];\n  if (entry === undefined) return; // ç¼“å­˜ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å› undefined\n  if (entry === this.tail) { // ç¼“å­˜æ˜¯æœ€æ–°çš„ï¼Œç›´æ¥è¿”å›è¿™ä¸ªç¼“å­˜é¡¹ï¼ˆæˆ–è€…å®ƒçš„å€¼ï¼‰\n    return returnEntry\n      ? entry\n      : entry.value;\n  }\n  // HEAD--------------TAIL\n  //   <.older   .newer>\n  //  <--- add direction --\n  //   A  B  C  <D>  E\n  if (entry.newer) { // å¦‚æœç¼“å­˜ä¸æ˜¯æœ€æ–°çš„\n    if (entry === this.head) { // å¦‚æœç¼“å­˜æ˜¯æœ€æ—§çš„\n      this.head = entry.newer; // å°†æ¯”å®ƒæ–°çš„ä½œä¸ºæœ€æ—§çš„\n    }\n    entry.newer.older = entry.older; // C <-- E. å°†å®ƒçš„åä¸€ä¸ªä½œä¸ºå‰ä¸€ä¸ªçš„æœ€æ—§\n  }\n  if (entry.older) { // å¦‚æœæœ‰æ¯”å®ƒæ›´æ—§çš„\n    entry.older.newer = entry.newer; // C. --> E å°†å®ƒçš„å‰ä¸€ä¸ªä½œä¸ºåä¸€ä¸ªçš„æœ€æ–°\n  }\n  entry.newer = undefined; // D --x // å®ƒæœ¬èº«æ²¡æœ‰æ›´æ–°çš„\n  entry.older = this.tail; // D. --> E\n  if (this.tail) {\n    this.tail.newer = entry; // E. <-- D\n  }\n  this.tail = entry; // å°†è‡ªå·±ä½œä¸ºæœ€æ–°çš„\n  return returnEntry\n    ? entry\n    : entry.value;\n}\n","import Cache from './cache';\nimport { isUndefined } from './utils';\n\nconst pathCache = new Cache(1000);\n\nconst TrimRE = /^\\s+|\\s$/g;\nconst WordsRE = /([a-zA-Z$][\\w.$]*)/g;\n\n// ä¸€ä¸ªåˆ«åå¯¹åº”ä¸€ä¸ªä½œç”¨åŸŸ\nfunction parseExpressionFor(exp, scope) {\n  var vars = exp.split(/\\s+in\\s+/);\n  var alias = vars[0], expression = vars[1];\n  return {\n    alias: alias,\n    raw: expression,\n    scope: expression,\n    expression: parseExpressionGetter(expression, scope)\n  };\n}\n\nexport function splitPath(expression) {\n  expression = expression.replace(/^\\s+|\\s$/g, ''); // trim\n  var wordsRE = /([a-zA-Z$][\\w.$]*)/g;\n  return expression.match(wordsRE) || [];\n}\n\nconst saveRE = /[\\{,]\\s*[\\w\\$_]+\\s*:|('(?:[^'\\\\]|\\\\.)*'|\"(?:[^\"\\\\]|\\\\.)*\")/g;\nconst restoreRE = /\"(\\d+)\"/g;\nconst wsRE = /\\s/g;\nconst newlineRE = /\\n/g;\nconst identRE = /[^\\w$\\.](?:[A-Za-z_$][\\w$]*)/g;\n\nvar saved = [];\n\nfunction save (str, isString) {\n  var i = saved.length\n  saved[i] = isString\n    ? str.replace(newlineRE, '\\\\n')\n    : str\n  return '\"' + i + '\"'\n}\n\nfunction rewrite (raw, scope) {\n  var c = raw.charAt(0);\n  var path = raw.slice(1);\n  path = path.indexOf('\"') > -1\n    ? path.replace(restoreRE, restore)\n    : path;\n  var scopeVarKey = '';\n  for (let i = scope.length - 1; i >= 0; --i) { // ä»åå¾€å‰\n    var _scope = scope[i];\n    var namePaths = parsePath(path);\n    if (namePaths.length > 0 && namePaths[0] === _scope.alias) { // åŒ¹é…åˆ°åˆ«åï¼Œè¯´æ˜åœ¨å½“å‰ä½œç”¨åŸŸ\n      namePaths = namePaths.slice(1);\n      scopeVarKey = _scope.scope + '[' + _scope.$index + ']' + (namePaths.length > 0 ? '.' + namePaths.join('.') : '');\n      break;\n    }\n  }\n  var body = 'vm.get(\"' + (scopeVarKey ? scopeVarKey : path) + '\")';\n  return c + body;\n}\n\nfunction restore (str, i) {\n  return saved[i];\n}\n\n/**\n * è§£æä¸€ä¸ªè¡¨è¾¾å¼\n * @param {String} expression è¡¨è¾¾å¼å­—ç¬¦ä¸²\n * @param {String} scope ä½œç”¨åŸŸé™åˆ¶\n * @return {Function} ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥è¿”å›è¡¨è¾¾å¼çš„å€¼\n */\nexport function parseExpressionGetter(expression, scope) {\n  saved.length = 0;\n  var parsed = expression\n    .replace(saveRE, save)\n    .replace(wsRE, '');\n  parsed = (' ' + parsed)\n    .replace(identRE, function(raw) {\n      return rewrite(raw, scope);\n    })\n    .replace(restoreRE, restore);\n  return makeGetterFunction(parsed);\n}\n\nfunction makeGetterFunction(body) {\n  return new Function('vm', 'return ' + body + ';');\n}\n\n/**\n * parseExpression è§£æè¡¨è¾¾å¼\n * å¯¹äº `b-for` æŒ‡ä»¤ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œå…¶å®ƒæŒ‡ä»¤åªè¦è¿”å›è¡¨è¾¾å¼æ‰§è¡Œå‡½æ•°å³å¯\n *\n * @param {String} name æŒ‡ä»¤åç§°\n * @param {String} expression è¡¨è¾¾å¼å­—ç¬¦ä¸²\n * @param {String} ä½œç”¨åŸŸé™åˆ¶\n * @return {{raw:String, expression:Function}}\n */\nexport function parseExpression(name, expression, scope) {\n  if (name === 'b-for') {\n    return parseExpressionFor(expression, scope);\n  }\n  if (name === 'b-on') {\n    return {\n      raw: expression,\n      expression: expression\n    };\n  }\n  return {\n    raw: expression,\n    expression: parseExpressionGetter(expression, scope)\n  };\n}\n\n/**\n * parsePath è§£æå–å€¼è·¯å¾„ï¼Œè¿”å›çœŸæ­£çš„å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œè¿”å› undefined\n *\n * @param {Object} data\n * @param {String} path\n * @return {*} value\n * @throw {Error} ä¸åˆæ³•çš„è·¯å¾„\n *\n * @example\n * parsePath('a.b.c') === ['a', 'b', 'c']\n */\nexport function parsePath(path) {\n  var hit = pathCache.get(path);\n  if (hit) {\n    return hit;\n  }\n  // data.a.b.c ğŸ‘\n  // data.a[\"b\"].c ğŸ‘\n  // data[\"a\"][\"b\"][\"c\"] ğŸ‘\n  // data.a[\"b.c\"] ğŸ‘\n  // data[\"a.b.c\"] ğŸ‘\n  // data.a[b] ğŸ‘\n  // data.a[b.c] ğŸ‘\n  var parts = path.split(/\\[|\\]/g), i = 0;\n  var props = [];\n  while (i < parts.length) {\n    var match1 = /^(\\.)?[^\\'\\\"\\.\\s]+(\\.[^\\'\\\"\\.\\s]+)*$/.test(parts[i]);\n    var match2 = /(^\\s*\\'.+\\'\\s*$)|(^\\s*\\\".+\\\"\\s*$)|(^\\s*$)/.test(parts[i]);\n    if (!(match1 || match2)) {\n      throw new Error(\"ä¸åˆæ³•çš„è·¯å¾„: \" + path);\n    }\n    if (match1) {\n      var _props = parts[i].split('.'), j = 0;\n      while(j < _props.length) {\n        if (_props[j] === '') {\n          if (i !== 0) {\n            j++;\n            continue;\n          } else {\n            throw new Error(\"ä¸åˆæ³•çš„è·¯å¾„: \" + path);\n          }\n        } else {\n          props.push(_props[j]);\n        }\n        j++;\n      }\n    } else { // match2\n      if (!/^\\s*$/.test(parts[i])) {\n        var _prop = parts[i].replace(/^\\s*[\\\"\\']|[\\'\\\"]\\s*$/g, '');\n        props.push(_prop);\n      }\n    }\n    i++;\n  }\n  pathCache.put(path, props);\n  return props;\n}\n\nexport function getObjectFromPath(data, path) {\n  var props = parsePath(path);\n  var result = props.length > 0 ? data : undefined;\n  for (let i = 0; i < props.length; ++i) {\n    result = result[props[i]];\n    if (!result) {\n      break;\n    }\n  }\n  return result;\n}\n\nexport function setObjectFromPath(data, path, value) {\n  var props = parsePath(path);\n  var current = data, parent = data;\n  for (var i = 0; i < props.length - 1; ++i) {\n    parent = current;\n    current = current[props[i]];\n    if (isUndefined(current)) {\n      current = {};\n      parent[props[i]] = current;\n    }\n  }\n  if (i >= 0) {\n    if (typeof current === 'object') {\n     current[props[i]] = value;\n    } else {\n      current = {};\n      current[props[i]] = value;\n      parent[props[i-1]] = current;\n    }\n  }\n}\n","import { isArray } from '../utils';\n\nexport function addHook (hookName, callback) {\n  let callbacks = this._hooks[hookName];\n  if (!callbacks) {\n    callbacks = [];\n  }\n  if (isArray(callback)) {\n    callbacks = callbacks.concat(callback);\n  } else {\n    callbacks.push(callback);\n  }\n  this._hooks[hookName] = callbacks;\n}\n\nexport function removeHook (hookName, callback) {\n  const callbacks = this._hooks[hookName];\n  if (!callbacks || callbacks.length === 0) {\n    return this;\n  }\n  if (!callback) {\n    callbacks.splice(0, callbacks.length);\n  } else {\n    for (let i = 0; i < callbacks.length; ++i) {\n      if (callbacks[i] === callback) {\n        callbacks.splice(i, 1);\n        break;\n      }\n    }\n  }\n  return this;\n}\n\nexport function callHooks (hookName) {\n  const _callbacks = this._hooks[hookName] || [];\n  for (let i = 0; i < _callbacks.length; ++i) {\n    _callbacks[i].call(this);\n  }\n}\n","import { getElement, createElement, removeNode, createTextNode, createDocumentFragment, appendChild, replaceNode } from './dom';\nimport { diff, patch } from './vdom/vdom';\nimport h from './vdom/h';\nimport { isArray, warn, error, extend, clone, noop, isFunction, isPlainObject } from './utils';\nimport { parseExpression } from './parser';\nimport { addHook, removeHook, callHooks } from './api/hooks';\n\nfunction NaiveException (message) {\n  this.name = 'NaiveException';\n  this.message = message;\n}\n\nexport default function Naive (options) {\n  options = options || {};\n  this._hooks = {};\n  if (!isFunction(options.state)) {\n    // å¿…é¡»æ˜¯ function\n    throw new NaiveException('state å¿…é¡»æ˜¯ Function');\n  }\n  const _state = options.state();\n  if (isPlainObject(_state)) {\n    this.state = _state;\n  } else {\n    warn('state å¿…é¡»æ˜¯ plain object');\n    this.state = {};\n  }\n  this.render = function render () {\n    return options.render.call(this, h);\n  };\n  this.ele = null;\n  this._init(options);\n}\n\nNaive.createElement = h;\n\nconst prtt = Naive.prototype;\n\nprtt.setState = function setState (state) {\n  extend(this.state, state);\n  this.update();\n  return this;\n};\n\n// æ›´æ–°è§†å›¾\nprtt.update = function update () {\n  if (!this.mounted) { // å¦‚æœç»„ä»¶æ²¡æœ‰æŒ‚è½½åˆ°å…ƒç´ ä¸Šï¼Œä¸éœ€è¦æ›´æ–°è§†å›¾\n    return this;\n  }\n  const preVdom = this.vdom;\n  this.vdom = this.render();\n  // console.log(preVdom, this.vdom);\n  const patches = diff(preVdom, this.vdom);\n  console.log(patches);\n  if (patches) {\n    patch(this, this.ele, patches);\n  } else {\n    warn('ä¸éœ€è¦æ›´æ–°è§†å›¾');\n  }\n};\n\nprtt._init = function _init (options) {\n  const methods = options.methods || {};\n  // å°† methods ç§»åˆ° this\n  for (let m in methods) {\n    if (methods.hasOwnProperty(m)) {\n      if (this.hasOwnProperty(m)) {\n        warn(`å±æ€§ \"${m}\" å·²å­˜åœ¨`);\n      } else {\n        this[m] = methods[m];\n      }\n    }\n  }\n  const hooks = options.hooks || {};\n  for (let p in hooks) {\n    if (hooks.hasOwnProperty(p)) {\n      this._addHook(p, hooks[p]);\n    }\n  }\n  this.vdom = this.render();\n};\n\nprtt.mount = function mount (selector) {\n  const mountPoint = getElement(selector);\n  if (!mountPoint) {\n    throw new NaiveException('æ‰¾ä¸åˆ°æŒ‚è½½èŠ‚ç‚¹');\n  }\n  const vdom = this.vdom;\n  if (vdom.length) { // fragment\n    const docFragment = createDocumentFragment();\n    for (let i = 0; i < vdom.length; ++i) {\n      appendChild(typeof vdom[i] === 'string' ? createTextNode(vdom[i]) : vdom[i].render(this), docFragment);\n    }\n    this.ele = docFragment;\n  } else {\n    this.ele = vdom.render(this);\n  }\n  replaceNode(this.ele, mountPoint);\n  this.mounted = true;\n  this._callHooks('mounted');\n};\n\nprtt._callHooks = callHooks;\n\nprtt._addHook = addHook;\n\nprtt._removeHook = removeHook;\n\n// é”€æ¯ç»„ä»¶\nprtt.destroy = function destroy () {\n  // é”€æ¯äº‹ä»¶ç›‘å¬\n  // è°ƒç”¨ destroy å‹¾å­\n  this._callHooks('destroy');\n  // é”€æ¯å‹¾å­å›è°ƒ\n  for (let p in this._hooks) {\n    if (this._hooks.hasOwnProperty(p)) {\n      this._removeHook(p);\n    }\n  }\n};\n"],"names":["warn","message","window","console","isArray","Array","obj","Object","prototype","toString","call","extend","props","i","isFunction","isPlainObject","getElement","selector","query","createElement","tag","document","createTextNode","text","createDocumentFragment","context","querySelector","removeNode","node","parentNode","removeChild","replaceNode","newNode","replaceChild","appendChild","el","target","setAttr","attr","value","setAttribute","VText","data","render","vdom2dom","VNode","tagName","children","key","String","undefined","childNodes","length","child","isVNode","isVText","push","count","checkAttrDirective","test","isEventDirective","attachEvent","eventName","handler","addEventListener","p","slice","evt","PATCH","patch","domNode","patches","dfsWalk","index","currentPatches","len","patchReorder","moves","move","type","INSERT","insertBefore","item","REMOVE","isAttrDirective","patchProps","hasOwnProperty","applyPatches","REPLACE","PROPS","TEXT","REORDER","makeKeyIndexAndFree","list","keyIndex","free","itemKey","listDiff","pList","nList","nMap","nKeys","nFree","pMap","pKeys","pFree","freeIndex","itemKeyIndex","remove","insert","simulateList","splice","s","n","nItem","nItemKey","sItem","sItemKey","diff","oldTree","newTree","diffWalk","pNode","nNode","propsPatches","diffProps","oldTreeProps","newTreeProps","diffChildren","pChildNodes","nChildNodes","diffs","newChildren","reorderPatch","leftNode","currentNodeIndex","h","Cache","limit","size","head","tail","_keymap","create","put","removed","entry","get","shift","newer","older","returnEntry","pathCache","restoreRE","saved","restore","str","parsePath","path","hit","parts","split","match1","match2","Error","_props","j","_prop","replace","addHook","hookName","callback","callbacks","_hooks","concat","removeHook","callHooks","_callbacks","NaiveException","name","Naive","options","state","_state","ele","_init","prtt","setState","update","mounted","preVdom","vdom","log","methods","m","hooks","_addHook","mount","mountPoint","docFragment","_callHooks","_removeHook","destroy"],"mappings":"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"}